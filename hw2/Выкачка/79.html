<!DOCTYPE html>
<html data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D" lang="ru">
<head>



<title>О новых угрозах для криптодержателей в 2023 году —  Enigma Stealer / Хабр</title>














































</head>
<body>
<div data-async-called="true" data-server-rendered="true" id="app"><div class="tm-layout__wrapper"><!-- --> <div></div> <div class="tm-feature tm-feature"><!-- --></div> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><div class="tm-header__burger-nav"><button class="tm-header__button tm-header__button_burger" type="button"><svg class="tm-svg-img tm-header__icon tm-header__icon-burger" height="16" width="16"><title>Меню</title> <use xlink:href="/img/megazord-v28.617e16ca..svg#header-burger"></use></svg></button></div> <span class="tm-header__logo-wrap"><a class="tm-header__logo tm-header__logo_ru" href="/ru/"><svg class="tm-svg-img tm-header__icon" height="16" width="16"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <!-- --> <div class="tm-header-user-menu tm-header_user-menu"><a class="tm-header-user-menu__item tm-header-user-menu__search" href="/ru/search/"><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search" height="24" width="24"><title>Поиск</title> <use xlink:href="/img/megazord-v28.617e16ca..svg#search"></use></svg></a> <!-- --> <!-- --> <!-- --> <div class="tm-header-user-menu__item"><button class="tm-header-user-menu__toggle" data-test-id="menu-toggle-guest"><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_white" height="24" width="24"><title>Профиль</title> <use xlink:href="/img/megazord-v28.617e16ca..svg#header-user"></use></svg></button> <!-- --></div> <!-- --></div></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <!-- --> <!-- --> <div class="tm-page-width"></div> <main class="tm-layout__container"><div class="tm-page" companyname="first" data-async-called="true" hl="ru"><div class="tm-page-width"><div class="tm-page__header"><!-- --></div> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><!-- --> <div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg class="tm-svg-img pull-down__arrow" height="24" width="24"><title>Обновить</title> <use xlink:href="/img/megazord-v28.617e16ca..svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet tm-article-snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a class="tm-user-info__userpic" href="/ru/users/FirstJohn/" title="FirstJohn"><div class="tm-entity-image"><img alt="" class="tm-entity-image__pic" height="32" src="//habrastorage.org/r/w32/getpro/habr/avatars/98e/121/3eb/98e1213ebc70c1aab2b403215b498bf5.png" width="32"/></div></a> <span class="tm-user-info__user"><a class="tm-user-info__username" href="/ru/users/FirstJohn/">
      FirstJohn
      <!-- --></a> <span class="tm-article-datetime-published"><time datetime="2023-03-10T04:08:01.000Z" title="2023-03-10, 07:08">вчера в 07:08</time></span></span></span></div> <!-- --></div> <h1 class="tm-article-snippet__title tm-article-snippet__title_h1" lang="ru"><span>О новых угрозах для криптодержателей в 2023 году —  Enigma Stealer</span></h1> <div class="tm-article-snippet__stats"><!-- --> <div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Время на прочтение</title> <use xlink:href="/img/megazord-v28.617e16ca..svg#clock"></use></svg></span> <span class="tm-article-reading-time__label">
    12 мин
  </span></div> <span class="tm-icon-counter tm-data-icons__item"><svg class="tm-svg-img tm-icon-counter__icon" height="24" width="24"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.617e16ca..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">1.6K</span></span></div> <div class="tm-article-snippet__hubs-container"><div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a class="tm-article-snippet__hubs-item-link router-link-active" href="/ru/company/first/blog/"><span>Блог компании FirstVDS</span> <!-- --></a></span><span class="tm-article-snippet__hubs-item"><a class="tm-article-snippet__hubs-item-link" href="/ru/hub/infosecurity/"><span>Информационная безопасность</span> <span class="tm-article-snippet__profiled-hub" title="Профильный хаб">*</span></a></span><span class="tm-article-snippet__hubs-item"><a class="tm-article-snippet__hubs-item-link" href="/ru/hub/cryptocurrency/"><span>Криптовалюты</span> <!-- --></a></span></div></div> <!-- --> <!-- --> <!-- --></div></div> <!-- --> <div class="tm-article-body" data-gallery-root="" lang="ru"><div></div> <div id="post-content-body"><div><div class="article-formatted-body article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><figure class="full-width"><img data-src="https://habrastorage.org/getpro/habr/upload_files/edc/440/fab/edc440fabbbd35db1b5e181e596db6cc.png" height="844" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/edc/440/fab/edc440fabbbd35db1b5e181e596db6cc.png" width="1500"/></figure><p>Приветствую, читатель. Все больше и больше людей предпочитают хранить свои сбережения в криптовалюте, и этому есть логическое объяснение. Безопасность, анонимность, практичность и относительная простота. </p><p>Но это лишь одна сторона монеты, ведь стоит открыть новости, и вы заметите десятки заголовков об очередной краже чьих‑то сбережений. В одной из своих статей я уже рассказывал вам о возможных рисках для криптодержателей. </p><p>Но недавно <a href="https://www.trendmicro.com/ru_ru/research/23/b/enigma-stealer-targets-cryptocurrency-industry-with-fake-jobs.html"><u>исследователи из компании</u></a>, занимающейся кибербезопасностью, Trendmicro заметили новый тип вредоносного ПО, которое распространялось через фишинговые рассылки и уязвимость CVE-2015–2291 в драйвере Intel. Имя этой угрозе — Enigma.</p><p>Подвержены воздействию этого плохиша все версии Windows. Вирус способен выполнять как функции стиллера, воруя файлы, содержащие в себе секретные фразы от кошельков и Cookie, так и функции дроппера, загружая на устройство жертвы следующую ступень или совершенно другой вредонос.</p><p>Дро́пперы — семейство вредоносных программ, предназначенных для несанкционированной и скрытой от пользователя установки на компьютер жертвы других вредоносных программ, содержащихся в самом теле дроппера или загружаемых по сети.</p><h2>Пути заражения новой угрозой</h2><p>Так называемый Enigma Stealer достаточно быстро распространяется, заражая пользователей, которые так или иначе связаны с криптосферой, не только в России, но и по всему миру. Особое внимание было уделено Центральной Европе, где жертвы исчисляются уже сотнями.</p><p>В основном все происходит достаточно банально, и существует два варианта фишинговых атак с использованием этого стиллера.</p><ol><li><p>Жертва получает на свой эмейл письмо, в котором злоумышленник представляется известной компанией и предлагает трудоустройство, по классике, во вложениях будет архив, в котором находится вредоносный файл, замаскированный под документ Microsoft Word.</p></li><li><p>Жертва получает письмо на свой электронный адрес, но злодей представляется уже журналистом и попросит вас пройти небольшой опрос, тематически связанный с криптовалютой. </p></li></ol><p>Кстати, мне удалось заполучить примерный список вопросов, и выглядит он следующим образом: </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/090/6c4/6df/0906c46dfc24012ae56dcb45ffe0a45f.png" height="425" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/090/6c4/6df/0906c46dfc24012ae56dcb45ffe0a45f.png" title="" width="619"/></figure><p>А вот как выглядит содержимое архива:</p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/25e/017/7ca/25e0177ca4d342089a5ee39fd6ed5a73.png" height="104" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/25e/017/7ca/25e0177ca4d342089a5ee39fd6ed5a73.png" title="" width="753"/></figure><h2>Краткий технический анализ уязвимости CVE-2015-2291</h2><p>Как уже упоминалось ранее, вредонос также может распространяться с помощью этой уязвимости, но в основном используется как дополнительная ступень для повышения привилегий или загрузки вирусного драйвера. Поговорим немного о этой дыре, которую Microsoft пытаются закрыть уже несколько лет. Более подробное описание можно будет найти <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nc-wdm-driver_initialize"><u>вот здесь.</u></a></p><p>Это уязвимость в драйвере iqvw64e.sys, который отвечает за диагностику сетевого адаптера. Да, это та самая функция «Поиск неисправностей устройства». </p><p>Поскольку этот компонент может напрямую взаимодействовать с устройством и выполнять множество подпрограмм ядра, предоставляя доступ к нескольким IOCTL, для злоумышленников он становится хорошей мишенью. </p><p>IOCTL, или коды ввода‑вывода, используются для связи между приложениями пользовательского режима и драйверами или для внутренней связи между драйверами. Подробнее можно узнать <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/introduction-to-i-o-control-codes"><u>вот здесь</u></a>.</p><p>Злоумышленник может получить доступ к следующим кодам. </p><ul><li><p>Код управления вводом-выводом, который будет использоваться для обращения к уязвимому кодовому пути — 0x80862007.</p></li><li><p>Код 0x33 для обращения к memmov. </p></li><li><p>Код 0х30 для обращения к memset. </p></li></ul><p>Код 0x28 для обращения к DriverEntry, что позволяет злоумышленнику загружать драйвера из произвольных источников.</p><ul><li><p>Код 0x27 для обращения к DeviceControl, позволяющей злоумышленнику передать структуру и внедрить её в подпрограмму ядра.</p></li></ul><p>Самое печальное, что для выполнение этих операций не требуются права администратора, то есть инициировать этот процесс может непривилегированный пользователь, а любые другие проверки отсутствуют. Это создает серьезную угрозу безопасности.</p><p>Использование злоумышленником этой дыры в защите Windows можно рассматривать под разными углами, так как применений у неё хоть отбавляй, но в инциденте с Enigma Stealer злоумышленники просто заменяли драйвер Windows Defender»a на свой вредоносный файл или повышали привилегии вирусному процессу в зависимости от обстоятельств.</p><h2>Краткий статистический анализ вредоноса</h2><p>Итак, для статистического анализа будем использовать следующий набор утилит, все они являются бесплатными и находятся в открытом доступе: </p><ol><li><p>DIE — Detect it Easy: многофункциональный инструмент, имеющий просто огромный арсенал. Позволит нам опередить тип компилятора вредоноса, язык, библиотеки и таблицы импорта/экспорта с последующим дизассемблированием. </p></li><li><p>Hidra — как и прошлая утилита, уже светилась <a href="https://habr.com/ru/company/first/blog/703954/"><u>в моей статье.</u></a> Прекрасный и многофункциональный инструмент для реверс-инжиниринга. </p></li><li><p>IDA PRO — также инструмент для реверс-инжиниринга.</p></li><li><p>Reko — декомпилятор, также знаком нам с прошлых статей.</p></li></ol><p>Как и в прошлой статье, мне захотелось сперва проверить этот файлик через VirusTotal, чтобы потом было легче делать выводы, мол, такие антивирусы хорошие, а такие — совсем не видят в файле угрозу. Результаты меня порадовали, 47 из 71 — это достаточно хороший результат. </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/dbe/421/eb1/dbe421eb10af209c86b4a1a9cb404068.png" height="849" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/dbe/421/eb1/dbe421eb10af209c86b4a1a9cb404068.png" title="" width="896"/></figure><p>Итак, после распаковки заветного архива у нас перед глазами появляется, как и упоминалось ранее, два файла: ничем не примечательный текстовый документ и исполняемый .exe, который очень неумело замаскирован под Microsoft Word. </p><p>Размер вредоноса составляет 273 килобайта, при просмотре свойств, к моему удивлению, удалось обнаружить некоторую информацию: </p><figure class=""><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/71c/8fd/a4b/71c8fda4bc49d28d66c883a20569c92e.png" height="519" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/71c/8fd/a4b/71c8fda4bc49d28d66c883a20569c92e.png" title="" width="416"/></figure><p>Естественно, это нам ничего не дает, только вот описание файла немного не стыкуется с маскировкой.</p><p>По классике, воспользуемся DIE для получения дополнительной информации. </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/0a5/7f7/aa5/0a57f7aa597b65b704713b05a1cc7a96.png" height="491" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/0a5/7f7/aa5/0a57f7aa597b65b704713b05a1cc7a96.png" title="" width="843"/></figure><p>Как и прошлые исследуемые, это PE файл, написан на C/C++, а используемый компилятор — Microsoft Visual C/C++ 2017. Но здесь злоумышленник пренебрег использованием метода, который изменяет дату компиляции, что не является таким уж и критичным. </p><p>Теперь задействуем Гидру, дабы определить специфику работы данного вируса. И на этом этапе начинается самое интересное, ведь вредонос не является цельной конструкцией и состоит из отдельных ступеней, каждая из которых выполняет свои функции и инициирует следующую. </p><p>Давайте обрисую вам общую инфраструктуру. </p><ol><li><p>Первый этап. Начальный загрузчик. Исключительно скачивание необходимых файлов для выполнения следующего шага.</p></li><li><p>Второй этап. Вторичный загрузчик. Представлен библиотекой UpdateTask.dll, которая эксплуатирует уязвимость CVE-2015-2291, повышает привилегии и отключает защитник Windows. Также загружает дроппер третьей ступени.</p></li><li><p>Третий этап. Снова дроппер. Скачивает основную полезную нагрузку в виде Enigma Stealer.</p></li><li><p>Четвертый этап. Развертывание Enigma. </p></li></ol><h2>Анализ первого этапа</h2><p>Общую информацию о дроппере первого этапа вы уже видели выше, поэтому перейдем непосредственно к краткому анализу кода. Также затронем особенности, присущие именно этому типу вредоносного ПО. </p><p>По классике, начинаем с импортируемых библиотек, их всего-то четыре:</p><ul><li><p>USER32.dll</p></li><li><p>ADVAPI32.dll</p></li><li><p>KERNELL.dll</p></li><li><p>RPCRT4.dll </p></li></ul><p>Этот загрузчик выполняет следующую цепочку процессов: </p><ul><li><p>l. Расшифровка зашифрованных строк.</p></li><li><p>ll. Создание мьютекса и загрузка второй ступени.</p></li></ul><h4>l. Расшифровка зашифрованных строк</h4><p>Создатели этого чуда явно знают свое дело, так как дроппер использует сразу несколько приемов, затрудняющих обнаружение и процесс реверс-инжиниринга. Повсеместно в коде можно встретить хешированные API и нерелевантный код. </p><p>Хеширование API — это метод, который вредоносные программы используют для сокрытия потенциально опасных API функций от статического обнаружения. Простыми словами, вредонос маскирует свои запросы к функциям определенных библиотек, чтобы остаться в тени и уйти от глаз антивируса. </p><p>Нерелевантный код — это фрагменты кода, никак не относящиеся к вредоносному ПО. Это могут быть фрагменты других приложений, которые никак не взаимодействуют с системой жертвы. Делается это для того, чтобы запутать и усложнить процесс анализа. </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/1ab/d74/1e7/1abd741e7c6077ffa7b4729190c1bbe1.png" height="519" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/1ab/d74/1e7/1abd741e7c6077ffa7b4729190c1bbe1.png" title="" width="624"/></figure><p>Итак, давайте более подробно разберем хеширование вредоносных функций в нашем образце первого этапа. </p><p>Допустим, очевидно вредоносная функция «CreateMutexA», отвечающая за проверку и создания мьютекса. </p><p>Мью́текс — примитив синхронизации, обеспечивающий взаимное исключение выполнения критических участков кода.</p><p>Говоря уж совсем простым языком — это простая проверка, запущен ли уже процесс вируса на данном устройстве или нет.</p><p>Так вот, в нашем коде она представлена значением 0x0GD53265B. Это то самое хэш-значение, которое используется для вызова соответствующей функции. Если в теории это и может обвести вокруг пальца несколько антивирусов, то на практике эффективность крайне низкая. Дело в том, что это значение все равно расшифровывается в вышеупомянутую функцию. Но безусловно это затрудняет процесс анализа.  </p><p>Непосредственно использование хеша происходит посредством функции «mw_resolveAPI» с указанием двух аргументов. Первый отвечает за хэш библиотеки, к которой идет обращение, вторым же идет непосредственно сама функция. </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/265/0a1/bf0/2650a1bf01fbf49a3cadbc4c8953a7cc.png" height="597" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/265/0a1/bf0/2650a1bf01fbf49a3cadbc4c8953a7cc.png" title="" width="609"/></figure><p>И как оказалось, Гидра снова не справилась. Показав таблицу импорта из четырех .dll файлов, что оказалось неверным. На самом деле вредонос задействует более 15 системных файлов.</p><h4>ll. Создание мьютекса и загрузка второй ступени  </h4><p>Сперва вредонос извлекает MachineGUID (цифровой идентификатор системы), происходит это с помощью обращения к реестру Windows по следующему пути: </p><pre></pre><p>Также полученное значение будет использоваться в качестве ID на командном сервере. </p><p>Затем вредонос удаляет следующий путь реестра:</p><pre></pre><p>Иногда безвозвратно. Но иногда создает его заново с двумя новыми значениями <em>HWID</em> и <em>ID</em>. Или автор не понимает смысла этого действия, или оно действительно лишено смысла. </p><p>Следом происходит создание мьютекса: </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/718/65c/ba0/71865cba09eb85addf78ea307905ce9e.png" height="447" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/718/65c/ba0/71865cba09eb85addf78ea307905ce9e.png" title="" width="736"/></figure><p>После этого происходит связь с командным сервером, IP-адрес которого был зашифрован с помощью того же самого пользовательского Мурхеша, и выглядит следующим образом: </p><pre></pre><p>Стоит также отметить, что это обычный PHP сервер, но к нему мы вернемся немного позже. </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/f4e/ca5/2df/f4eca52df6a72368b61bae38c4dc8061.png" height="365" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/f4e/ca5/2df/f4eca52df6a72368b61bae38c4dc8061.png" title="" width="770"/></figure><p>Вредонос отправляет на сервер идентификатор системы и версию .NET Framework. </p><p>Но чтобы произвести загрузку следующего этапа, вирус уже будет связываться с API бота в Telegram, запрос построен в виде обычного обращения к файлу: </p><pre></pre><p>Затем происходит отправка сообщения «Бот получил», и от этого стартует уже вторая ступень.</p><h2>Краткий анализ второго этапа</h2><p>Как я уже писал выше, полезная нагрузка этого этапа представлена в виде .dll файла. Размером она в 498 КБ и написана на C++. </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/00a/37c/617/00a37c61742ce0b4e21afdb5a5624943.png" height="274" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/00a/37c/617/00a37c61742ce0b4e21afdb5a5624943.png" title="" width="1106"/></figure><p>Имеет вредоносный .dll две основные функции. </p><ol><li><p>Отключить Microsoft Defender путем развертывания вредоносного драйвера. Та самая эксплуатация CVE-2015-2291, описанной ранее. </p></li><li><p>Загрузка и выполнение следующего этапа. </p></li></ol><p>Стоит отметить, что повышения привилегий процесса именно в этом образце не прописано, но обязательной является проверка на наличие прав администратора. </p><p>Делается это с помощью API запроса к функции GetTokenInformation: </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/ff5/3ce/64b/ff53ce64b7a529998778cab5de2eb735.png" height="109" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/ff5/3ce/64b/ff53ce64b7a529998778cab5de2eb735.png" title="" width="932"/></figure><p>Далее производится удаление системного драйвера Защитника Windows и, используя уязвимость, вредонос загружает свой. Примечательно, что имя этого файла написано на кириллице — драйвер.sys. </p><p>После этого производится закрепление в системе, дроппер вносит себя в планировщик задач и реестр. </p><p>И наконец происходит загрузка и запуск следующего этапа, он также представлен дроппером. В самом скачивании нет ничего примечательного, оно происходит аналогично через Telegram API.</p><h2>Краткий анализ третьего этапа</h2><p>Как по мне, он уже совсем не существенен и вовсе был не нужен, но мотивы злоумышленников мне уловить порой очень сложно. Что ж, перед нашими глазами находится ещё один дроппер. </p><p>На этот раз он написан на C# и весит всего 11 КБ. </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/98a/5eb/b6b/98a5ebb6b8f2682ca428a5234c24797b.png" height="300" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/98a/5eb/b6b/98a5ebb6b8f2682ca428a5234c24797b.png" title="" width="1148"/></figure><p>Его единственной функция — скачать окончательную полезную нагрузку в виде стиллера Enigma. Но зачем-то он имеет возможность контролироваться с помощью того же API Телеграм. Злоумышленник, если просто передумает, может остановить выполнение финальной фазы.</p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/33c/f2a/1d3/33cf2a1d369122a0bb40eccc26455482.png" height="958" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/33c/f2a/1d3/33cf2a1d369122a0bb40eccc26455482.png" title="" width="1021"/></figure><h2>Анализ финальной фазы: Enigma Stealer</h2><p>Наконец—то. Следующие данные мы получаем после простого визуального осмотра стиллера: 1534 KБ, исходное имя — stub.exe и копирайтинг, который ссылается на GitHub репозиторий — Stealerum. </p><figure class=""><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/a2d/c60/0ed/a2dc600ed5c7e7c5916f969aca5be129.png" height="527" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/a2d/c60/0ed/a2dc600ed5c7e7c5916f969aca5be129.png" title="" width="432"/></figure><p>И на этом моменте автор потерял себя, надежда увидеть что-то уникальное и эксклюзивное полностью исчезла. </p><p>Как оказалось, Enigma является модифицированной версией этого самого репозитория. </p><p>Так уж и быть, по классике, воспользуемся DIE для получения дополнительной информации. </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/e26/ea4/a2d/e26ea4a2dd4a7e1ab88421d249d38d4b.png" height="487" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/e26/ea4/a2d/e26ea4a2dd4a7e1ab88421d249d38d4b.png" title="" width="847"/></figure><p>Из интересного стоит отметить, что он написан на C# и здесь уже был использован метод изменяющий дату компиляции. </p><p>Это «Timestomping», он представляет собой антикриминалистический метод, используемый для того, чтобы ввести следствие и специалистов быстрого реагирования в заблуждение.</p><p>Вирустотал показал замечательные показатели обнаружения: </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/32b/2ac/a6d/32b2aca6d664c176edc3126e492d83b9.png" height="947" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/32b/2ac/a6d/32b2aca6d664c176edc3126e492d83b9.png" title="" width="982"/></figure><p>А теперь непосредственно к делу. Для реверс-инжиниринга вредоносов,  написанных с помощью C#, мы будем использовать следующий сетап утилит: </p><ol><li><p>DNSpy — декомпилятор, дизассемблер и дебаггер в одном. Хороший, простой и бесплатный. </p></li><li><p>Reco &amp; DotPeek — запасной вариант, выполняют те же функции. И уже неоднократно фигурировали в моих статьях.</p></li></ol><p>Вскрываем и анализируем. Поехали. </p><p>По классике, разметим основной алгоритм работы вредоноса. </p><ul><li><p>Создание рабочей директории и загрузка конфигурационных файлов. </p></li><li><p>Сбор информации о системе и кража данных. </p></li><li><p>Отправка данных злоумышленнику через телеграм-бота. </p></li></ul><h4>Создание рабочей директории и загрузка конфигурационных файлов</h4><p>Сразу после запуска происходит процесс создания рабочего каталога, в разных версиях стиллера этот процесс отличается, но конкретно в нашем он представлен следующим участком кода: </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/683/2a2/4e2/6832a24e2e4cd15c8e85ca1c23536d22.png" height="249" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/683/2a2/4e2/6832a24e2e4cd15c8e85ca1c23536d22.png" title="" width="804"/></figure><p>Сразу после этого происходит процесс обработки конфига вредоноса, если он отсутствует — производится его загрузка с командного сервера. </p><p>Конфигурация нашего вредоноса выглядит следующим образом: </p><p> </p><figure class=""><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/eb7/9a8/286/eb79a828653158f7a44f9d4ac2b54f12.png" height="451" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/eb7/9a8/286/eb79a828653158f7a44f9d4ac2b54f12.png" title="" width="444"/></figure><p>Исходя из этого мы можем определить используемые модули и базовые возможности стиллера. Основными являются Keylogger и Grabber. </p><p><strong>Keylogger</strong> — в данной ситуации это модуль, главным назначением которого является скрытый мониторинг нажатий клавиш на клавиатуре и ведение журнала.</p><p><strong>Grabber</strong> — модуль, отвечающий за непосредственно сбор печенек и других файлов. </p><p>Затем вредонос начинает собирать системную информацию и крадет информацию о пользователях, токены и пароли из различных веб-браузеров и приложений, таких как Google Chrome, Microsoft Edge, Microsoft Outlook, Telegram, Signal, OpenVPN и других. Также вредонос создает снимки экрана и отправляет все данные в Telegram. </p><p>После чего собранные данные будут помещены в архив посредством «CreateArchive», это вы можете увидеть на скриншоте, как и список собираемой информации: </p><figure class=""><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/c22/bdd/4c7/c22bdd4c7e7823524e773dacca6796c6.png" height="927" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/c22/bdd/4c7/c22bdd4c7e7823524e773dacca6796c6.png" title="" width="212"/></figure><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/243/004/ac2/243004ac27dd38f8939ba0bc26c342ef.png" height="611" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/243/004/ac2/243004ac27dd38f8939ba0bc26c342ef.png" title="" width="963"/></figure><p>Логика отправки данных в бота Телеграм выглядит следующим образом, ничего особо примечательного в ней нет: </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/2d6/678/8c7/2d66788c7a0e742af628aea40720afee.png" height="592" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/2d6/678/8c7/2d66788c7a0e742af628aea40720afee.png" title="" width="1281"/></figure><h4>Краткий динамический анализ вредоноса</h4><p>Все тесты проводятся на виртуальной машине, ни в коем случае не повторяйте этого самостоятельно, тем более на основной. </p><p>Для динамического анализа у нас уже имеется следующий сетап утилит (все они находятся в открытом доступе):</p><ol><li><p>ProcessHacker — простенько и со вкусом, понаблюдаем за тем, как вирус взаимодействует с другими .dll и системой. </p></li><li><p>TCPView — утилита, которая прослеживает исходящие TCP соединения. </p></li><li><p>Regshot — очень простое приложение с открытым исходным кодом, которое позволит просмотреть изменения в реестре после запуска вредоноса. </p></li></ol><p>По классике, делаем слепок нашего реестра, открываем все приложения и наблюдаем. </p><p>Сразу же после открытия процесс вируса устанавливает соединение с командным PHP сервером, и некоторое время ничего не происходит. </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/6b7/bfc/f0c/6b7bfcf0c0449c17cad9a50f5115e2e0.png" height="357" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/6b7/bfc/f0c/6b7bfcf0c0449c17cad9a50f5115e2e0.png" title="" width="1549"/></figure><p>Затем появляются ещё несколько процессов, которые уже начинают получение какой-то информации с того же самого IP-адреса. Так и происходит загрузка второй ступени. </p><p>Далее в ProcessHacker начинает маячить новый процесс Update.exe, нагружает центральный процессор на максимум и утихает. </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/262/992/ca6/262992ca6533542f37cfc7483dc12454.png" height="282" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/262/992/ca6/262992ca6533542f37cfc7483dc12454.png" title="" width="1600"/></figure><p>На этом моменте, если проверить планировщик задач Windows, можно увидеть следующее: </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/5a8/892/f36/5a8892f363708d187ad6153bb72fef78.png" height="321" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/5a8/892/f36/5a8892f363708d187ad6153bb72fef78.png" title="" width="1205"/></figure><p>Это свидетельствует об успешном выполнении второй ступени вредоноса, ведь задача отвечает за ежедневное выполнение вредоносного .dll файла updateTask. </p><p>На снимках реестра можно увидеть то самое удаление раздела Intel в реестре Windows: </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/e67/2da/ab8/e672daab86ff2e06b7442966dea8e35c.png" height="239" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/e67/2da/ab8/e672daab86ff2e06b7442966dea8e35c.png" title="" width="1278"/></figure><p>Но после этого выполнение прервалось по неизвестным мне причинам. </p><h4>Немного о командном PHP сервере</h4><p>Всего мы успели заметить два IP адреса, первый исходит от начальной ступени, второй же — от вредоносного .dll. </p><p>Второй нам не особо интересен, так как ссылается сразу же на API Телеграма: </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/fb6/750/9c1/fb67509c1dd6db6d2c2c0d1549253d60.png" height="928" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/fb6/750/9c1/fb67509c1dd6db6d2c2c0d1549253d60.png" title="" width="1512"/></figure><p>Но вот первый является достаточно интересным экземпляром, так как из него можно извлечь некоторую полезную информацию. </p><p>При переходе по этому айпи адресу нас встретила очень неприветливая форма авторизации, но меня посетила мысль проверить доступность файла info.php. И оказалось, что здесь он присутствовал. </p><p>PHPinfo — это функция, которая отображает информацию о конфигурации PHP и сервера. Она помогает PHP-разработчикам видеть, какие модули активны и какие версии этих модулей работают на сервере</p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/602/2bf/a8d/6022bfa8d5182bb543dbd955625ce6d0.png" height="266" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/602/2bf/a8d/6022bfa8d5182bb543dbd955625ce6d0.png" title="" width="1259"/></figure><p>А сам информационный файл выглядел так: </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/017/162/cba/017162cba62c4ec449c90fbefa4bc6a1.png" height="365" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/017/162/cba/017162cba62c4ec449c90fbefa4bc6a1.png" title="" width="650"/></figure><p>Дениска Хакер? Интересно. Но что более поражающее, этот сервер, скорее всего, расположен в Москве, но я не исключаю возможности, что эта информация была указана с целью ввести следствие в заблуждение: </p><figure class="full-width"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/fd3/6c5/fbb/fd36c5fbb8acc060b82ce4b079c3e792.png" height="172" src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/fd3/6c5/fbb/fd36c5fbb8acc060b82ce4b079c3e792.png" title="" width="956"/></figure><h2>Выводы</h2><p>И вот так вот подходит к концу этот анализ. На самом деле, использование множества дропперов действительно в чем-то имеет преимущество. Ведь злоумышленник может вмешаться практически на любой стадии и внести коррективы, если что-то пошло не по его плану. </p><p>Атаки с использованием Enigma Stealer имеют таргетированный характер и направлены на криптодержателей, но никто не говорил, что злодеи не могут атаковать всех подряд. Как и в большинстве случаев, лучшей защитой от этого и других вредоносов является голова на плечах. </p><p>Никогда не ведитесь на различные рассылки и все-все прочее, где вам обещают золотые горы и престижную работу. Тем более не скачивайте вложения с таких подозрительных писем. </p><p>На данный момент Enigma и его дропперная инфраструктура не представляют особой опасности. Ведь каждая его ступень с легкостью определяется большинством антивирусных приложений.  </p><p>А на этом у меня все. Бывайте. </p><hr/><p>НЛО прилетело и оставило здесь промокод для читателей нашего блога:</p><p>— <a href="https://firstvds.ru/?utm_source=habr&amp;utm_medium=article&amp;utm_campaign=product&amp;utm_content=vds15exeptprogrev"><u>15% на все тарифы VDS</u></a> (кроме тарифа Прогрев) — <strong>HABRFIRSTVDS</strong>.</p><p></p></div></div></div> <!-- --> <!-- --></div> <!-- --> <!-- --></div> <!-- --> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a class="tm-tags-list__link" href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%83%D1%8F%D0%B7%D0%B2%D0%B8%D0%BC%D0%BE%D1%81%D1%82%D1%8C%5D">уязвимость</a></li><li class="tm-separated-list__item"><a class="tm-tags-list__link" href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D0%B0%D1%8F%20%D0%B1%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D0%BE%D1%81%D1%82%D1%8C%5D">информационная безопасность</a></li><li class="tm-separated-list__item"><a class="tm-tags-list__link" href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Benigma%5D">enigma</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a class="tm-hubs-list__link router-link-active" href="/ru/company/first/blog/">Блог компании FirstVDS</a></li><li class="tm-separated-list__item"><a class="tm-hubs-list__link" href="/ru/hub/infosecurity/">Информационная безопасность</a></li><li class="tm-separated-list__item"><a class="tm-hubs-list__link" href="/ru/hub/cryptocurrency/">Криптовалюты</a></li></ul></div></div></article></div> <!-- --></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article" height="24" width="24"><title>Всего голосов 5: ↑5 и ↓0</title> <use xlink:href="/img/megazord-v28.617e16ca..svg#counter-rating"></use></svg> <span class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating" title="Всего голосов 5: ↑5 и ↓0">+5</span></div> <div class="v-portal" style="display:none;"></div></div> <!-- --> <!-- --> <button class="bookmarks-button tm-data-icons__item" title="Добавить в закладки" type="button"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.617e16ca..svg#counter-favorite"></use></svg></span> <span class="bookmarks-button__counter" title="Количество пользователей, добавивших публикацию в закладки">
    10
  </span></button> <div class="tm-sharing tm-data-icons__item" title="Поделиться"><button class="tm-sharing__button" type="button"><svg class="tm-sharing__icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z" fill="currentColor"></path></svg></button> <div class="v-portal" style="display:none;"></div></div> <div class="tm-article-comments-counter-link tm-data-icons__item" title="Читать комментарии"><a class="tm-article-comments-counter-link__link" href="/ru/company/first/blog/721226/comments/"><svg class="tm-svg-img tm-article-comments-counter-link__icon" height="24" width="24"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.617e16ca..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      2
    </span></a> <!-- --></div> <!-- --> <div class="v-portal" style="display:none;"></div></div></div></div> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!-- --> <div></div> <section class="tm-block tm-block tm-block_spacing-bottom"><!-- --> <div class="tm-block__body tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"><div class="tm-article-author__company"><div class="tm-article-author__company-card"><div class="tm-company-snippet"><a class="tm-company-snippet__logo-link" href="/ru/company/first/profile/"><div class="tm-entity-image"><img alt="" class="tm-entity-image__pic" height="40" src="//habrastorage.org/getpro/habr/company/3a5/515/806/3a5515806f33cd7076d16cd91c9bc9e3.png" width="40"/></div></a> <div class="tm-company-snippet__info"><a class="tm-company-snippet__title" href="/ru/company/first/profile/">FirstVDS</a> <div class="tm-company-snippet__description">Виртуальные и выделенные серверы в ДЦ в Москве</div></div></div> <div class="tm-article-author__buttons"><!-- --> <!-- --></div></div> <div class="tm-article-author__company-contacts"><a class="tm-article-author__contact" href="https://firstvds.ru" rel="noopener" target="_blank">
      Сайт
    </a><a class="tm-article-author__contact" href="https://1dedic.ru" rel="noopener" target="_blank">
      Сайт
    </a><a class="tm-article-author__contact" href="https://clo.ru" rel="noopener" target="_blank">
      Сайт
    </a><a class="tm-article-author__contact" href="https://vk.com/firstvds" rel="noopener" target="_blank">
      ВКонтакте
    </a><a class="tm-article-author__contact" href="https://telegram.me/TakeFirstNews" rel="noopener" target="_blank">
      Telegram
    </a></div> <div class="tm-article-author__separator"></div></div> <div class="tm-user-card tm-article-author__user-card tm-user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a class="tm-user-card__userpic tm-user-card__userpic_size-40" href="/ru/users/FirstJohn/"><div class="tm-entity-image"><img alt="" class="tm-entity-image__pic" src="//habrastorage.org/getpro/habr/avatars/98e/121/3eb/98e1213ebc70c1aab2b403215b498bf5.png"/></div></a> <div class="tm-user-card__meta"><div class="tm-counter-container tm-karma tm-karma" title=" 243 голоса "><div class="tm-counter-container__header"><div class="tm-karma__votes tm-karma__votes_positive">
      107
    </div></div> <div class="tm-counter-container__footer"><div class="tm-karma__text">
      Карма
    </div> <div class="v-portal" style="display:none;"></div></div></div> <div class="tm-counter-container" title="Рейтинг пользователя"><div class="tm-counter-container__header"> <div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!-- --> <div class="tm-votes-lever__score tm-votes-lever__score tm-votes-lever__score_appearance-rating"><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter tm-votes-lever__score-counter_rating">
        48.8
      </span></div> <!-- --></div></div> <div class="tm-counter-container__footer"><span class="tm-rating__text tm-rating__text">
      Рейтинг
    </span></div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title tm-user-card__title_variant-article"><!-- --> <a class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article" href="/ru/users/FirstJohn/">
          @FirstJohn
        </a> <!-- --></div> <p class="tm-user-card__short-info tm-user-card__short-info tm-user-card__short-info_variant-article">Маркетолог</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons tm-user-card__buttons_variant-article"><!-- --> <!-- --> <!-- --> <!-- --> <!-- --></div></div> <!-- --></div> <div class="v-portal" style="display:none;"></div></div> <!-- --></section> <!-- --> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style" href="/ru/company/first/blog/721226/comments/"><svg class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted" height="24" width="24"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.617e16ca..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 2 
    </span></a> <!-- --></div></div></div> <section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header tm-block__header_variant-borderless"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title tm-block__title_variant-large">Публикации</h2> </div> <!-- --></header> <div class="tm-block__body tm-block__body tm-block__body_variant-condensed-slim"><div class="tm-tabs tm-tabs"><div><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_active tm-tabs__tab-link_slim">
        Лучшие за сутки
      </button></span><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_slim">
        Похожие
      </button></span></div> <!-- --></div> <div class="similar-and-daily__tab-view"><div><!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <div class="tm-placeholder-article-cards"><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div></div> <!-- --> <!-- --> <!-- --> <!-- --></div> <!-- --></div></div> <!-- --></section> <div><!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <div class="tm-placeholder-inset tm-placeholder-vacancies"><div class="tm-placeholder-inset__header"><div class="tm-placeholder__line tm-placeholder__line_inset-header loads"></div></div> <div class="tm-placeholder-inset__body"><ul class="tm-placeholder-list"><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li></ul></div> <div class="tm-placeholder-inset__footer"><div class="tm-placeholder__line tm-placeholder__line_inset-footer loads"></div></div></div> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --> <!-- --></div> <!-- --> </div></div></div></div></div> <div class="tm-page__sidebar"><!-- --></div></div></div></div></main> <!-- --></div> <!-- --> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><div class="tm-footer__title"><a class="tm-svg-icon__wrapper tm-footer__title-link router-link-active" href="/ru/"><svg class="tm-svg-img tm-svg-icon" height="16" width="16"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a></div> <div class="tm-footer__social"><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="16" width="16"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="16" width="16"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="16" width="16"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="16" width="16"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="16" width="16"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="16" width="16"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <div class="v-portal" style="display:none;"></div> <button class="tm-footer__link"><svg class="tm-svg-img tm-footer__icon" height="16" width="16"><title>Язык</title> <use xlink:href="/img/megazord-v28.617e16ca..svg#lang"></use></svg>
        Настройка языка
      </button> <a class="tm-footer__link" href="/ru/feedback/">
        Техническая поддержка
      </a> <a class="tm-footer__link" href="/berserk-mode-nope">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2023, </span> <span class="tm-copyright__name"><a class="tm-copyright__link" href="https://company.habr.com/" rel="noopener" target="_blank">Habr</a></span></span></div></div></div></div> <!-- --> <!-- --></div> <div class="vue-portal-target"></div></div>





<noscript>
<div>
<img alt="" src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;"/>
</div>
</noscript>


</body>
</html>
